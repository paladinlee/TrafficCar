<!DOCTYPE html>
<html lang="zh-Hant">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>交通車路線</title>
    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
</head>

<body>
    <!-- 導覽列 -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="index.html">交通車路線</a>

            <!-- 這顆按鈕在手機會顯示，點擊可展開選單 -->
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="切換選單">
                <span class="navbar-toggler-icon"></span>
            </button>

            <!-- 注意這裡要加上 id="navbarNav"，跟 data-bs-target 對應 -->
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item"><a class="nav-link" href="index.html?route=minA">民生線(早)</a></li>
                    <li class="nav-item"><a class="nav-link" href="index.html?route=minB">民生線(晚)</a></li>
                    <li class="nav-item"><a class="nav-link" href="index.html?route=trun">重慶線</a></li>
                    <li class="nav-item"><a class="nav-link" href="index.html?route=toyan">桃園線</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- 內容區 -->
    <div class="container mt-4">
        <h3 id="routeTitle" class="mb-3">交通車路線</h3>
        <div class="table-responsive">
            <table class="table table-bordered table-striped">
                <thead class="table-dark">
                    <tr>
                        <th>時間</th>
                        <th>地名</th>
                        <th>Google Map</th>
                        <th>Apple Map</th>
                    </tr>
                </thead>
                <tbody id="routeTable">
                    <!-- jQuery 生成 -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- JSON + Script -->
    <script>
        // 路線資料
        const routesData = {
            "minA": {
                "name": "民生線",
                "stops": [
                    { "time": "06:20", "place": "民生活動中心", "NE": "25.059271437032145,121.56358211908851" },
                    { "time": "06:25", "place": "南京松江捷運2號出口", "NE": "25.051306,121.532833" },
                    { "time": "06:33", "place": "富邦銀行", "NE": "25.032814437017937,121.53272406660767" },
                    { "time": "06:35", "place": "懷恩堂", "NE": "25.01778187784632,121.53337590495687" },
                    { "time": "06:38", "place": "台大活動中心對面", "NE": "25.012779593343435,121.53607488211394" },
                    { "time": "06:45", "place": "秀朗國小對面", "NE": "24.99991455208375,121.52115350315138" },
                    { "time": "06:50", "place": "景平路", "NE": "24.992867569562854,121.5111794012165" },
                    { "time": "06:55", "place": "景安捷運站", "NE": "24.993658370523,121.50484014313092" },
                    { "time": "06:58", "place": "圓通路口", "NE": "24.994003147253167,121.4959269239468" },
                    { "time": "07:00", "place": "中正路488號", "NE": "24.994396136160542,121.48924560522225" },
                    { "time": "07:55", "place": "74館前面", "NE": "24.773298360553607,121.0470121072169" },
                    { "time": "07:57", "place": "51館", "NE": "24.773885053363276,121.04450851525927" },
                    { "time": "07:59", "place": "22館", "NE": "24.776282129956005,121.04331336066015" },
                    { "time": "08:00", "place": "10P停車場", "NE": "24.772960106349874,121.04733012843961" }
                ]
            },
            "minB": {
                "name": "民生線",
                "stops": [
                    { "time": "07:30", "place": "台北車站" },
                    { "time": "08:00", "place": "民生社區" }
                ]
            },
            "trun": {
                "name": "重慶線",
                "stops": [
                    { "time": "07:10", "place": "中壢火車站" },
                    { "time": "07:40", "place": "內壢交流道" }
                ]
            },
            "toyan": {
                "name": "桃園線",
                "stops": [
                    { "time": "07:20", "place": "桃園車站" },
                    { "time": "07:50", "place": "中正藝文特區" }
                ]
            }
        };

        // 取得網址參數 route
        function getQueryParam(param) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }

        $(function () {
            const routeKey = getQueryParam("route") || "minA"; // 預設民生線(早)
            const route = routesData[routeKey];

            if (!route) {
                $("#routeTitle").text("查無此路線");
                return;
            }

            $("#routeTitle").text(route.name + " - 時刻表");
            $("#routeTable").empty();

            route.stops.forEach(stop => {
                $("#routeTable").append(`
          <tr>
            <td>${stop.time}</td>
            <td>${stop.place}</td>
            <td>
            <div class="d-flex flex-wrap gap-2">
                <a href="comgooglemaps://?daddr=${stop.NE}&directionsmode=driving" class="btn btn-sm btn-success">手機</a>
                <a href="https://www.google.com/maps/dir/?api=1&destination=${stop.NE}&travelmode=driving" target="_blank" class="btn btn-sm btn-primary">瀏覽器</a>
            </div>
            </td>
            <td>
            <div class="d-flex flex-wrap gap-2">
                <a href="maps://?daddr=${stop.NE}&dirflg=d" class="btn btn-sm btn-success">手機</a>
                <a href="https://maps.apple.com/?daddr=${stop.NE}&dirflg=d" target="_blank" class="btn btn-sm btn-primary">瀏覽器</a>
            </div>
            </td>
          </tr>
        `);
            });
        });
    </script>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>